{% extends "cast/bootstrap5/feed_detail.html" %}
{% load static %}

{% block podlove_subscribe_button %}
  <script>
    window.podcastData = {
      "title": "{{ blog.title|escapejs }}",
      "subtitle": "{{ blog.subtitle|escapejs }}",
      "description": "{{ blog.description|striptags|escapejs }}",
      {% if blog.itunes_artwork %}
        "cover": "{{ blog.itunes_artwork.original.url|escapejs }}",
      {% endif %}
      "feeds": [
        {% for feed in podcast_feeds %}
          {
            "type": "audio",
            "format": "{% if feed.format == 'mp3' %}mp3{% elif feed.format == 'm4a' %}aac{% elif feed.format == 'oga' %}ogg{% elif feed.format == 'opus' %}opus{% endif %}",
            "url": "{{ request.scheme }}://{{ request.get_host }}{{ feed.rss_url|escapejs }}",
            {% if apple_podcasts_url %}
              "directory-url-itunes": "{{ apple_podcasts_url|escapejs }}"
            {% endif %}
          }{% if not forloop.last %},{% endif %}
        {% endfor %}
      ]
    };
  </script>
  <script class="podlove-subscribe-button"
          src="{% static 'subscribe_button/javascripts/app.js' %}"
          async
          data-language="de"
          data-size="big"
          data-json-data="podcastData"
          data-color="#469cd1"
          data-format="cover"
          data-style="filled">
  </script>
  <noscript><a href="{{ podcast_feeds.0.rss_url }}">Subscribe to feed</a></noscript>
{% endblock podlove_subscribe_button %}
